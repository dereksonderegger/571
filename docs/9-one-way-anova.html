<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 One way ANOVA | Statistical Methods II</title>
  <meta name="description" content="The second semester of an Intro Stats course designed for graduate students in Biology, Forestry, Ecology, etc." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 One way ANOVA | Statistical Methods II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The second semester of an Intro Stats course designed for graduate students in Biology, Forestry, Ecology, etc." />
  <meta name="github-repo" content="dereksonderegger/STA_571_Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 One way ANOVA | Statistical Methods II" />
  
  <meta name="twitter:description" content="The second semester of an Intro Stats course designed for graduate students in Biology, Forestry, Ecology, etc." />
  

<meta name="author" content="Derek L. Sonderegger" />


<meta name="date" content="2020-06-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="8-variable-selection.html"/>
<link rel="next" href="10-two-way-anova.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Methods II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html"><i class="fa fa-check"></i><b>1</b> Matrix Theory</a><ul>
<li class="chapter" data-level="1.1" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#learning-outcomes"><i class="fa fa-check"></i><b>1.1.1</b> Learning Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#types-of-matrices"><i class="fa fa-check"></i><b>1.2</b> Types of Matrices</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#scalars"><i class="fa fa-check"></i><b>1.2.1</b> Scalars</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#vectors"><i class="fa fa-check"></i><b>1.2.2</b> Vectors</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#matrix"><i class="fa fa-check"></i><b>1.2.3</b> Matrix</a></li>
<li class="chapter" data-level="1.2.4" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#square-matrices"><i class="fa fa-check"></i><b>1.2.4</b> Square Matrices</a></li>
<li class="chapter" data-level="1.2.5" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#symmetric-matrices"><i class="fa fa-check"></i><b>1.2.5</b> Symmetric Matrices</a></li>
<li class="chapter" data-level="1.2.6" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#diagonal-matrices"><i class="fa fa-check"></i><b>1.2.6</b> Diagonal Matrices</a></li>
<li class="chapter" data-level="1.2.7" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#identity-matrices"><i class="fa fa-check"></i><b>1.2.7</b> Identity Matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#operations-on-matrices"><i class="fa fa-check"></i><b>1.3</b> Operations on Matrices</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#transpose"><i class="fa fa-check"></i><b>1.3.1</b> Transpose</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#addition-and-subtraction"><i class="fa fa-check"></i><b>1.3.2</b> Addition and Subtraction</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#multiplication"><i class="fa fa-check"></i><b>1.3.3</b> Multiplication</a></li>
<li class="chapter" data-level="1.3.4" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#vector-multiplication"><i class="fa fa-check"></i><b>1.3.4</b> Vector Multiplication</a></li>
<li class="chapter" data-level="1.3.5" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#matrix-multiplication"><i class="fa fa-check"></i><b>1.3.5</b> Matrix Multiplication</a></li>
<li class="chapter" data-level="1.3.6" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#scalar-times-a-matrix"><i class="fa fa-check"></i><b>1.3.6</b> Scalar times a Matrix</a></li>
<li class="chapter" data-level="1.3.7" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#determinant"><i class="fa fa-check"></i><b>1.3.7</b> Determinant</a></li>
<li class="chapter" data-level="1.3.8" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#inverse"><i class="fa fa-check"></i><b>1.3.8</b> Inverse</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-matrix-theory.html"><a href="1-matrix-theory.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html"><i class="fa fa-check"></i><b>2</b> Maximum Likelihood Priciple</a><ul>
<li class="chapter" data-level="2.1" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#learning-outcomes-1"><i class="fa fa-check"></i><b>2.1.1</b> Learning Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#distributions"><i class="fa fa-check"></i><b>2.2</b> Distributions</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#poisson"><i class="fa fa-check"></i><b>2.2.1</b> Poisson</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#exponential"><i class="fa fa-check"></i><b>2.2.2</b> Exponential</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#normal"><i class="fa fa-check"></i><b>2.2.3</b> Normal</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#likelihood-function"><i class="fa fa-check"></i><b>2.3</b> Likelihood Function</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#poisson-1"><i class="fa fa-check"></i><b>2.3.1</b> Poisson</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#exponential-example"><i class="fa fa-check"></i><b>2.3.2</b> Exponential Example</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#normal-1"><i class="fa fa-check"></i><b>2.3.3</b> Normal</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#discussion"><i class="fa fa-check"></i><b>2.4</b> Discussion</a></li>
<li class="chapter" data-level="2.5" data-path="2-maximum-likelihood-priciple.html"><a href="2-maximum-likelihood-priciple.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html"><i class="fa fa-check"></i><b>3</b> Parameter Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#learning-outcomes-2"><i class="fa fa-check"></i><b>3.1.1</b> Learning Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#simple-regression"><i class="fa fa-check"></i><b>3.2</b> Simple Regression</a><ul>
<li class="chapter" data-level="3.2.1" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#estimation-of-location-paramters"><i class="fa fa-check"></i><b>3.2.1</b> Estimation of Location Paramters</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#estimation-of-variance-parameter"><i class="fa fa-check"></i><b>3.2.2</b> Estimation of Variance Parameter</a></li>
<li class="chapter" data-level="3.2.3" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#expectation-and-variance-of-a-random-vector"><i class="fa fa-check"></i><b>3.2.3</b> Expectation and variance of a random vector</a></li>
<li class="chapter" data-level="3.2.4" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#variance-of-location-parameters"><i class="fa fa-check"></i><b>3.2.4</b> Variance of Location Parameters</a></li>
<li class="chapter" data-level="3.2.5" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#confidence-intervals-and-hypothesis-tests"><i class="fa fa-check"></i><b>3.2.5</b> Confidence intervals and hypothesis tests</a></li>
<li class="chapter" data-level="3.2.6" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#summary-of-pertinent-results"><i class="fa fa-check"></i><b>3.2.6</b> Summary of pertinent results</a></li>
<li class="chapter" data-level="3.2.7" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#an-example-in-r"><i class="fa fa-check"></i><b>3.2.7</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#anova-model"><i class="fa fa-check"></i><b>3.3</b> ANOVA model</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#cell-means-representation"><i class="fa fa-check"></i><b>3.3.1</b> Cell means representation</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#offset-from-reference-group"><i class="fa fa-check"></i><b>3.3.2</b> Offset from reference group</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-parameter-estimation.html"><a href="3-parameter-estimation.html#exercises-2"><i class="fa fa-check"></i><b>3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-inference.html"><a href="4-inference.html"><i class="fa fa-check"></i><b>4</b> Inference</a><ul>
<li class="chapter" data-level="4.1" data-path="4-inference.html"><a href="4-inference.html#f-tests"><i class="fa fa-check"></i><b>4.1</b> F-tests</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-inference.html"><a href="4-inference.html#theory"><i class="fa fa-check"></i><b>4.1.1</b> Theory</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-inference.html"><a href="4-inference.html#testing-all-covariates"><i class="fa fa-check"></i><b>4.1.2</b> Testing All Covariates</a></li>
<li class="chapter" data-level="4.1.3" data-path="4-inference.html"><a href="4-inference.html#testing-a-single-covariate"><i class="fa fa-check"></i><b>4.1.3</b> Testing a Single Covariate</a></li>
<li class="chapter" data-level="4.1.4" data-path="4-inference.html"><a href="4-inference.html#testing-a-subset-of-covariates"><i class="fa fa-check"></i><b>4.1.4</b> Testing a Subset of Covariates</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-inference.html"><a href="4-inference.html#confidence-intervals-for-location-parameters"><i class="fa fa-check"></i><b>4.2</b> Confidence Intervals for location parameters</a></li>
<li class="chapter" data-level="4.3" data-path="4-inference.html"><a href="4-inference.html#prediction-and-confidence-intervals-for-a-response"><i class="fa fa-check"></i><b>4.3</b> Prediction and Confidence Intervals for a response</a></li>
<li class="chapter" data-level="4.4" data-path="4-inference.html"><a href="4-inference.html#interpretation-with-correlated-covariates"><i class="fa fa-check"></i><b>4.4</b> Interpretation with Correlated Covariates</a></li>
<li class="chapter" data-level="4.5" data-path="4-inference.html"><a href="4-inference.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-analysis-of-covariance-ancova.html"><a href="5-analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>5</b> Analysis of Covariance (ANCOVA)</a><ul>
<li class="chapter" data-level="5.1" data-path="5-analysis-of-covariance-ancova.html"><a href="5-analysis-of-covariance-ancova.html#offset-parallel-lines-aka-additive-models"><i class="fa fa-check"></i><b>5.1</b> Offset parallel Lines (aka additive models)</a></li>
<li class="chapter" data-level="5.2" data-path="5-analysis-of-covariance-ancova.html"><a href="5-analysis-of-covariance-ancova.html#lines-with-different-slopes-aka-interaction-model"><i class="fa fa-check"></i><b>5.2</b> Lines with different slopes (aka Interaction model)</a></li>
<li class="chapter" data-level="5.3" data-path="5-analysis-of-covariance-ancova.html"><a href="5-analysis-of-covariance-ancova.html#iris-example"><i class="fa fa-check"></i><b>5.3</b> Iris Example</a></li>
<li class="chapter" data-level="5.4" data-path="5-analysis-of-covariance-ancova.html"><a href="5-analysis-of-covariance-ancova.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-contrasts.html"><a href="6-contrasts.html"><i class="fa fa-check"></i><b>6</b> Contrasts</a><ul>
<li class="chapter" data-level="6.1" data-path="6-contrasts.html"><a href="6-contrasts.html#estimate-and-variance"><i class="fa fa-check"></i><b>6.1</b> Estimate and variance</a></li>
<li class="chapter" data-level="6.2" data-path="6-contrasts.html"><a href="6-contrasts.html#estimating-contrasts-using-glht"><i class="fa fa-check"></i><b>6.2</b> Estimating contrasts using <code>glht()</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-contrasts.html"><a href="6-contrasts.html#way-anova"><i class="fa fa-check"></i><b>6.2.1</b> 1-way ANOVA</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-contrasts.html"><a href="6-contrasts.html#ancova-example"><i class="fa fa-check"></i><b>6.2.2</b> ANCOVA example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-contrasts.html"><a href="6-contrasts.html#using-emmeans-package"><i class="fa fa-check"></i><b>6.3</b> Using <code>emmeans</code> Package</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-contrasts.html"><a href="6-contrasts.html#simple-regression-1"><i class="fa fa-check"></i><b>6.3.1</b> Simple Regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-contrasts.html"><a href="6-contrasts.html#way-anova-1"><i class="fa fa-check"></i><b>6.3.2</b> 1-way ANOVA</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-contrasts.html"><a href="6-contrasts.html#ancova"><i class="fa fa-check"></i><b>6.3.3</b> ANCOVA</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-contrasts.html"><a href="6-contrasts.html#exercises-5"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html"><i class="fa fa-check"></i><b>7</b> Diagnostics and Transformations</a><ul>
<li class="chapter" data-level="7.1" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#detecting-assumption-violations"><i class="fa fa-check"></i><b>7.1</b> Detecting Assumption Violations</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#measures-of-influence"><i class="fa fa-check"></i><b>7.1.1</b> Measures of Influence</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.1.2</b> Diagnostic Plots</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#transformations"><i class="fa fa-check"></i><b>7.2</b> Transformations</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#a-review-of-logx-and-ex"><i class="fa fa-check"></i><b>7.2.1</b> A review of <span class="math inline">\(\log(x)\)</span> and <span class="math inline">\(e^x\)</span></a></li>
<li class="chapter" data-level="7.2.2" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#transforming-the-response"><i class="fa fa-check"></i><b>7.2.2</b> Transforming the Response</a></li>
<li class="chapter" data-level="7.2.3" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#transforming-the-predictors"><i class="fa fa-check"></i><b>7.2.3</b> Transforming the predictors</a></li>
<li class="chapter" data-level="7.2.4" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#interpretation-of-log-transformed-variables"><i class="fa fa-check"></i><b>7.2.4</b> Interpretation of log transformed variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-diagnostics-and-transformations.html"><a href="7-diagnostics-and-transformations.html#exercises-6"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-variable-selection.html"><a href="8-variable-selection.html"><i class="fa fa-check"></i><b>8</b> Variable Selection</a><ul>
<li class="chapter" data-level="8.1" data-path="8-variable-selection.html"><a href="8-variable-selection.html#nested-models"><i class="fa fa-check"></i><b>8.1</b> Nested Models</a></li>
<li class="chapter" data-level="8.2" data-path="8-variable-selection.html"><a href="8-variable-selection.html#testing-based-model-selection"><i class="fa fa-check"></i><b>8.2</b> Testing-Based Model Selection</a><ul>
<li class="chapter" data-level="8.2.1" data-path="8-variable-selection.html"><a href="8-variable-selection.html#example---u.s.-life-expectancy"><i class="fa fa-check"></i><b>8.2.1</b> Example - U.S. Life Expectancy</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-variable-selection.html"><a href="8-variable-selection.html#criterion-based-procedures"><i class="fa fa-check"></i><b>8.3</b> Criterion Based Procedures</a><ul>
<li class="chapter" data-level="8.3.1" data-path="8-variable-selection.html"><a href="8-variable-selection.html#information-criterions"><i class="fa fa-check"></i><b>8.3.1</b> Information Criterions</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-variable-selection.html"><a href="8-variable-selection.html#adjusted-r-sq"><i class="fa fa-check"></i><b>8.3.2</b> Adjusted <code>R-sq</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="8-variable-selection.html"><a href="8-variable-selection.html#example"><i class="fa fa-check"></i><b>8.3.3</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-variable-selection.html"><a href="8-variable-selection.html#exercises-7"><i class="fa fa-check"></i><b>8.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html"><i class="fa fa-check"></i><b>9</b> One way ANOVA</a><ul>
<li class="chapter" data-level="9.1" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html#an-example"><i class="fa fa-check"></i><b>9.1</b> An Example</a></li>
<li class="chapter" data-level="9.2" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html#degrees-of-freedom"><i class="fa fa-check"></i><b>9.2</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="9.3" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html#diagnostics"><i class="fa fa-check"></i><b>9.3</b> Diagnostics</a></li>
<li class="chapter" data-level="9.4" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.4</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="9.5" data-path="9-one-way-anova.html"><a href="9-one-way-anova.html#exercises-8"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html"><i class="fa fa-check"></i><b>10</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="10.1" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#orthogonality"><i class="fa fa-check"></i><b>10.1</b> Orthogonality</a></li>
<li class="chapter" data-level="10.2" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#main-effects-model"><i class="fa fa-check"></i><b>10.2</b> Main Effects Model</a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#example---fruit-trees"><i class="fa fa-check"></i><b>10.2.1</b> Example - Fruit Trees</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#anova-table"><i class="fa fa-check"></i><b>10.2.2</b> ANOVA Table</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#estimating-contrasts"><i class="fa fa-check"></i><b>10.2.3</b> Estimating Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#interaction-model"><i class="fa fa-check"></i><b>10.3</b> Interaction Model</a><ul>
<li class="chapter" data-level="10.3.1" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#anova-table-1"><i class="fa fa-check"></i><b>10.3.1</b> ANOVA Table</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#example---fruit-trees-continued"><i class="fa fa-check"></i><b>10.3.2</b> Example - Fruit Trees (continued)</a></li>
<li class="chapter" data-level="10.3.3" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#example---warpbreaks"><i class="fa fa-check"></i><b>10.3.3</b> Example - Warpbreaks</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-two-way-anova.html"><a href="10-two-way-anova.html#exercises-9"><i class="fa fa-check"></i><b>10.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-block-designs.html"><a href="11-block-designs.html"><i class="fa fa-check"></i><b>11</b> Block Designs</a><ul>
<li class="chapter" data-level="11.1" data-path="11-block-designs.html"><a href="11-block-designs.html#randomized-complete-block-design-rcbd"><i class="fa fa-check"></i><b>11.1</b> Randomized Complete Block Design (RCBD)</a></li>
<li class="chapter" data-level="11.2" data-path="11-block-designs.html"><a href="11-block-designs.html#split-plot-designs"><i class="fa fa-check"></i><b>11.2</b> Split-plot designs</a></li>
<li class="chapter" data-level="11.3" data-path="11-block-designs.html"><a href="11-block-designs.html#exercises-10"><i class="fa fa-check"></i><b>11.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html"><i class="fa fa-check"></i><b>12</b> Mixed Effects Models</a><ul>
<li class="chapter" data-level="12.1" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#review-of-maximum-likelihood-methods"><i class="fa fa-check"></i><b>12.1</b> Review of Maximum Likelihood Methods</a></li>
<li class="chapter" data-level="12.2" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#way-anova-with-a-random-effect"><i class="fa fa-check"></i><b>12.2</b> 1-way ANOVA with a random effect</a></li>
<li class="chapter" data-level="12.3" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#blocks-as-random-variables"><i class="fa fa-check"></i><b>12.3</b> Blocks as Random Variables</a></li>
<li class="chapter" data-level="12.4" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#nested-effects"><i class="fa fa-check"></i><b>12.4</b> Nested Effects</a></li>
<li class="chapter" data-level="12.5" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#crossed-effects"><i class="fa fa-check"></i><b>12.5</b> Crossed Effects</a></li>
<li class="chapter" data-level="12.6" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#repeated-measures-longitudinal-studies"><i class="fa fa-check"></i><b>12.6</b> Repeated Measures / Longitudinal Studies</a></li>
<li class="chapter" data-level="12.7" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#confidence-and-prediction-intervals"><i class="fa fa-check"></i><b>12.7</b> Confidence and Prediction Intervals</a><ul>
<li class="chapter" data-level="12.7.1" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#confidence-intervals"><i class="fa fa-check"></i><b>12.7.1</b> Confidence Intervals</a></li>
<li class="chapter" data-level="12.7.2" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#prediction-intervals"><i class="fa fa-check"></i><b>12.7.2</b> Prediction Intervals</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="12-mixed-effects-models.html"><a href="12-mixed-effects-models.html#exercises-11"><i class="fa fa-check"></i><b>12.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html"><i class="fa fa-check"></i><b>13</b> Binomial Regression</a><ul>
<li class="chapter" data-level="13.1" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#binomial-regression-model"><i class="fa fa-check"></i><b>13.1</b> Binomial Regression Model</a></li>
<li class="chapter" data-level="13.2" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#measures-of-fit-quality"><i class="fa fa-check"></i><b>13.2</b> Measures of Fit Quality</a><ul>
<li class="chapter" data-level="13.2.1" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#deviance"><i class="fa fa-check"></i><b>13.2.1</b> Deviance</a></li>
<li class="chapter" data-level="13.2.2" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>13.2.2</b> Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#confidence-intervals-1"><i class="fa fa-check"></i><b>13.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="13.4" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#interpreting-model-coefficients"><i class="fa fa-check"></i><b>13.4</b> Interpreting model coefficients</a></li>
<li class="chapter" data-level="13.5" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#prediction-and-effective-dose-levels"><i class="fa fa-check"></i><b>13.5</b> Prediction and Effective Dose Levels</a></li>
<li class="chapter" data-level="13.6" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#overdispersion"><i class="fa fa-check"></i><b>13.6</b> Overdispersion</a></li>
<li class="chapter" data-level="13.7" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#roc-curves"><i class="fa fa-check"></i><b>13.7</b> ROC Curves</a></li>
<li class="chapter" data-level="13.8" data-path="13-binomial-regression.html"><a href="13-binomial-regression.html#exercises-12"><i class="fa fa-check"></i><b>13.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="project-appendix.html"><a href="project-appendix.html"><i class="fa fa-check"></i>Project Appendix</a><ul>
<li class="chapter" data-level="13.9" data-path="project-appendix.html"><a href="project-appendix.html#weeks-1-4-project-feasibility"><i class="fa fa-check"></i><b>13.9</b> Weeks 1 – 4 (Project Feasibility)</a><ul>
<li class="chapter" data-level="13.9.1" data-path="project-appendix.html"><a href="project-appendix.html#wibgis"><i class="fa fa-check"></i><b>13.9.1</b> WIBGIs</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Methods II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-way-anova" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> One way ANOVA</h1>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="9-one-way-anova.html#cb276-1"></a><span class="co"># Load the libraries I&#39;ll use</span></span>
<span id="cb276-2"><a href="9-one-way-anova.html#cb276-2"></a><span class="kw">library</span>(tidyverse)   <span class="co"># dplyr, tidyr, ggplot2</span></span>
<span id="cb276-3"><a href="9-one-way-anova.html#cb276-3"></a><span class="kw">library</span>(emmeans)     <span class="co"># all the pairwise contrasts stuff</span></span>
<span id="cb276-4"><a href="9-one-way-anova.html#cb276-4"></a><span class="kw">library</span>(ggfortify)   <span class="co"># for the autoplot function on lm() objects</span></span></code></pre></div>
<p>Given a categorical covariate (which I will call a factor) with <span class="math inline">\(I\)</span> levels, we are interested in fitting the model
<span class="math display">\[y_{ij}=\mu+\tau_{i}+\epsilon_{ij}\]</span>
where <span class="math inline">\(\epsilon_{ij}\stackrel{iid}{\sim}N\left(0,\sigma^{2}\right)\)</span>, <span class="math inline">\(\mu\)</span> is the overall mean, and <span class="math inline">\(\tau_{i}\)</span> are the offset of factor level <span class="math inline">\(i\)</span> from <span class="math inline">\(\mu\)</span>. Unfortunately this model is not identifiable because I could add a constant (say <span class="math inline">\(5\)</span>) to <span class="math inline">\(\mu\)</span> and subtract that same constant from each of the <span class="math inline">\(\tau_{i}\)</span> values and the group mean <span class="math inline">\(\mu+\tau_{i}\)</span> would not change. There are two easy restrictions we could make to make the model identifiable:</p>
<ol style="list-style-type: decimal">
<li><p>Set <span class="math inline">\(\mu=0\)</span>. In this case, <span class="math inline">\(\tau_{i}\)</span> represents the expected value of an observation in group level <span class="math inline">\(i\)</span>. We call this the “cell means” representation.</p></li>
<li><p>Set <span class="math inline">\(\tau_{1}=0\)</span>. Then <span class="math inline">\(\mu\)</span> represents the expected value of treatment <span class="math inline">\(1\)</span>, and the <span class="math inline">\(\tau_{i}\)</span> values will represent the offsets from group 1. The group or level that we set to be zero is then referred to as the reference group. We can call this the “offset from reference” model.</p></li>
</ol>
<p>We will be interested in testing the null and alternative hypotheses
<span class="math display">\[\begin{aligned}
H_{0}:\;\;y_{ij}    &amp;=  \mu+\epsilon_{ij}              \\
H_{a}:\;\;y_{ij}    &amp;=  \mu+\alpha_{i}+\epsilon_{ij}
\end{aligned}\]</span></p>
<div id="an-example" class="section level2">
<h2><span class="header-section-number">9.1</span> An Example</h2>
<p>We look at a dataset that comes from the study of blood coagulation times: 24 animals were randomly assigned to four different diets and the samples were taken in a random order. The diets are denoted as <span class="math inline">\(A\)</span>,<span class="math inline">\(B\)</span>,<span class="math inline">\(C\)</span>,and <span class="math inline">\(D\)</span> and the response of interest is the amount of time it takes for the blood to coagulate.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="9-one-way-anova.html#cb277-1"></a><span class="kw">data</span>(<span class="st">&#39;coagulation&#39;</span>, <span class="dt">package=</span><span class="st">&#39;faraway&#39;</span>)</span>
<span id="cb277-2"><a href="9-one-way-anova.html#cb277-2"></a><span class="kw">ggplot</span>(coagulation, <span class="kw">aes</span>(<span class="dt">x=</span>diet, <span class="dt">y=</span>coag)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-3"><a href="9-one-way-anova.html#cb277-3"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb277-4"><a href="9-one-way-anova.html#cb277-4"></a><span class="st">    </span><span class="kw">labs</span>( <span class="dt">x=</span><span class="st">&#39;Diet&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Coagulation Time&#39;</span> )</span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<p>Just by looking at the graph, we expect to see that diets <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are similar while <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> are different from <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> and possibly from each other, too. We first fit the offset model.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="9-one-way-anova.html#cb278-1"></a>m &lt;-<span class="st"> </span><span class="kw">lm</span>(coag <span class="op">~</span><span class="st"> </span>diet, <span class="dt">data=</span>coagulation)</span>
<span id="cb278-2"><a href="9-one-way-anova.html#cb278-2"></a><span class="kw">summary</span>(m)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = coag ~ diet, data = coagulation)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -5.00  -1.25   0.00   1.25   5.00 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 6.100e+01  1.183e+00  51.554  &lt; 2e-16 ***
## dietB       5.000e+00  1.528e+00   3.273 0.003803 ** 
## dietC       7.000e+00  1.528e+00   4.583 0.000181 ***
## dietD       2.991e-15  1.449e+00   0.000 1.000000    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.366 on 20 degrees of freedom
## Multiple R-squared:  0.6706, Adjusted R-squared:  0.6212 
## F-statistic: 13.57 on 3 and 20 DF,  p-value: 4.658e-05</code></pre>
<p>Notice that diet <span class="math inline">\(A\)</span> is the reference level and it has a mean of <span class="math inline">\(61\)</span>. Diet <span class="math inline">\(B\)</span> has an offset from <span class="math inline">\(A\)</span> of <span class="math inline">\(5\)</span>, etc. From the very small F-statistic, we conclude that simple model
<span class="math display">\[y_{ij}=\mu+\epsilon_{ij}\]</span>
is not sufficient to describe the data.</p>
</div>
<div id="degrees-of-freedom" class="section level2">
<h2><span class="header-section-number">9.2</span> Degrees of Freedom</h2>
<p>Throughout the previous example, the degrees of freedom that are reported keeps changed depending on what models we are comparing. The simple model we are considering is
<span class="math display">\[y_{ij}\sim\mu+\epsilon_{ij}\]</span>
which has 1 parameter that defines the expected value versus
<span class="math display">\[y_{ij}\sim\mu+\tau_{i}+\epsilon_{ij}\]</span>
where there really are only <span class="math inline">\(4\)</span> parameters that define the expected value because <span class="math inline">\(\tau_{1}=0\)</span>. In general, the larger model is only adding <span class="math inline">\(I-1\)</span> terms to the model where <span class="math inline">\(I\)</span> is the number of levels of the factor of interest.</p>
</div>
<div id="diagnostics" class="section level2">
<h2><span class="header-section-number">9.3</span> Diagnostics</h2>
<p>It is still important to check the diagnostics plots, but certain diagnostic plots will be useless. In particular, we need to be concerned about constant variance among the groups and normality of the residuals.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="9-one-way-anova.html#cb280-1"></a>m &lt;-<span class="st"> </span><span class="kw">lm</span>(coag <span class="op">~</span><span class="st"> </span>diet, <span class="dt">data=</span>coagulation)</span>
<span id="cb280-2"><a href="9-one-way-anova.html#cb280-2"></a><span class="kw">autoplot</span>(m, <span class="dt">which=</span><span class="dv">2</span>)  <span class="co">#  QQ plot</span></span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<p>The residual plots however, might need a little bit of extra work, because there are only four possible predicted values (actually <span class="math inline">\(3\)</span> because group <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> have the same predicted values). Note that we actually have <span class="math inline">\(n=24\)</span> observations, but I can only see 16 of them.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="9-one-way-anova.html#cb281-1"></a><span class="kw">plot</span>(m, <span class="dt">which=</span><span class="dv">1</span>)  <span class="co">#  Residals vs fitted</span></span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="9-one-way-anova.html#cb282-1"></a><span class="kw">autoplot</span>(m, <span class="dt">which=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>diet))</span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-179-2.png" width="672" /></p>
<p>To remedy this, we will plot the residuals vs fitted by hand, and add a little bit of random noise to the fitted value, just so that we don’t have points stack up on top of each other. Lets also add a different shape for each diet.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="9-one-way-anova.html#cb283-1"></a>coagulation<span class="op">$</span>fitted &lt;-<span class="st"> </span><span class="kw">predict</span>(m)</span>
<span id="cb283-2"><a href="9-one-way-anova.html#cb283-2"></a>coagulation<span class="op">$</span>resid &lt;-<span class="st"> </span><span class="kw">resid</span>(m)</span>
<span id="cb283-3"><a href="9-one-way-anova.html#cb283-3"></a><span class="kw">ggplot</span>(coagulation, <span class="kw">aes</span>(<span class="dt">x=</span>fitted, <span class="dt">y=</span>resid, <span class="dt">shape=</span>diet, <span class="dt">color=</span>diet)) <span class="op">+</span></span>
<span id="cb283-4"><a href="9-one-way-anova.html#cb283-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">w=</span><span class="fl">0.3</span>, <span class="dt">h=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="pairwise-comparisons" class="section level2">
<h2><span class="header-section-number">9.4</span> Pairwise Comparisons</h2>
<p>After detecting differences in the factor levels, we are often interested in which factor levels are different from which. Often we are interested in comparing the mean of level <span class="math inline">\(i\)</span> with the mean of level <span class="math inline">\(j\)</span>. As usual we let the vector of parameter estimates be <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> then the contrast of interested can be written as
<span class="math display">\[\boldsymbol{c}^{T}\hat{\boldsymbol{\beta}}\pm t_{n-p}^{1-\alpha/2}\;\hat{\sigma}\sqrt{\boldsymbol{c}^{T}\left(\boldsymbol{X}^{T}\boldsymbol{X}\right)^{-1}\boldsymbol{c}}\]</span> for some vector <span class="math inline">\(\boldsymbol{c}\)</span>.</p>
<p>Unfortunately this interval does not take into account the multiple comparisons issue (i.e. we are making <span class="math inline">\(I(I-1)/2\)</span> contrasts if our factor has <span class="math inline">\(I\)</span> levels). To account for this, we will not use a quantile from a t-distribution, but from Tukey’s studentized range distribution <span class="math inline">\(q_{n,n-I}\)</span> divided by <span class="math inline">\(\sqrt{2}\)</span>. The intervals we will use are:
<span class="math display">\[\boldsymbol{c}^{T}\hat{\boldsymbol{\beta}}\pm\frac{q_{n,n-I}^{1-\alpha/2}}{\sqrt{2}}\;\hat{\sigma}\sqrt{\boldsymbol{c}^{T}\left(\boldsymbol{X}^{T}\boldsymbol{X}\right)^{-1}\boldsymbol{c}}\]</span></p>
<p>There are several ways to make R calculate this interval (See the contrasts chapter for a more general treatment of this.), but the easiest is to use the <code>emmeans</code> package. This package computes the above intervals which are commonly known as Tukey’s Honestly Significant Differences.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="9-one-way-anova.html#cb284-1"></a>m &lt;-<span class="st"> </span><span class="kw">lm</span>(coag <span class="op">~</span><span class="st"> </span>diet, <span class="dt">data=</span>coagulation)   <span class="co"># use the lm() function as usual</span></span>
<span id="cb284-2"><a href="9-one-way-anova.html#cb284-2"></a><span class="kw">emmeans</span>(m, <span class="dt">specs=</span> pairwise<span class="op">~</span>diet) <span class="op">%&gt;%</span></span>
<span id="cb284-3"><a href="9-one-way-anova.html#cb284-3"></a><span class="st">  </span><span class="kw">summary</span>(<span class="dt">level=</span><span class="fl">0.90</span>)</span></code></pre></div>
<pre><code>## $emmeans
##  diet emmean    SE df lower.CL upper.CL
##  A        61 1.183 20     59.0     63.0
##  B        66 0.966 20     64.3     67.7
##  C        68 0.966 20     66.3     69.7
##  D        61 0.837 20     59.6     62.4
## 
## Confidence level used: 0.9 
## 
## $contrasts
##  contrast estimate   SE df t.ratio p.value
##  A - B          -5 1.53 20 -3.273  0.0183 
##  A - C          -7 1.53 20 -4.583  0.0010 
##  A - D           0 1.45 20  0.000  1.0000 
##  B - C          -2 1.37 20 -1.464  0.4766 
##  B - D           5 1.28 20  3.912  0.0044 
##  C - D           7 1.28 20  5.477  0.0001 
## 
## P value adjustment: tukey method for comparing a family of 4 estimates</code></pre>
<p>Here we see that diets <span class="math inline">\(A\)</span> and <span class="math inline">\(D\)</span> are similar to each other, but different than <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> and that <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> are not statistically different from each other at the <span class="math inline">\(0.10\)</span> level.</p>
<p>Often I want to produce the “Compact Letter Display” which identifies which groups are significantly different.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="9-one-way-anova.html#cb286-1"></a>LetterData &lt;-<span class="st"> </span><span class="kw">emmeans</span>(m, <span class="dt">specs=</span> <span class="op">~</span><span class="st"> </span>diet) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># cld() will freak out if you have pairwise here...</span></span>
<span id="cb286-2"><a href="9-one-way-anova.html#cb286-2"></a><span class="st">  </span>multcomp<span class="op">::</span><span class="kw">cld</span>(<span class="dt">Letters=</span>letters, <span class="dt">level=</span><span class="fl">0.95</span>) <span class="op">%&gt;%</span></span>
<span id="cb286-3"><a href="9-one-way-anova.html#cb286-3"></a><span class="st">  </span><span class="kw">mutate</span>( <span class="dt">y =</span> <span class="dv">73</span> )   <span class="co"># height to place the letters at. </span></span>
<span id="cb286-4"><a href="9-one-way-anova.html#cb286-4"></a>LetterData</span></code></pre></div>
<pre><code>##   diet emmean        SE df lower.CL upper.CL .group  y
## 1    A     61 1.1832160 20 58.53185 63.46815     a  73
## 2    D     61 0.8366600 20 59.25476 62.74524     a  73
## 3    B     66 0.9660918 20 63.98477 68.01523      b 73
## 4    C     68 0.9660918 20 65.98477 70.01523      b 73</code></pre>
<p>I can easily add these to my boxplot with the following:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="9-one-way-anova.html#cb288-1"></a><span class="kw">ggplot</span>(coagulation, <span class="kw">aes</span>(<span class="dt">x=</span>diet, <span class="dt">y=</span>coag)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb288-2"><a href="9-one-way-anova.html#cb288-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb288-3"><a href="9-one-way-anova.html#cb288-3"></a><span class="st">    </span><span class="kw">labs</span>( <span class="dt">x=</span><span class="st">&#39;Diet&#39;</span>, <span class="dt">y=</span><span class="st">&#39;Coagulation Time&#39;</span> ) <span class="op">+</span></span>
<span id="cb288-4"><a href="9-one-way-anova.html#cb288-4"></a><span class="st">  </span><span class="kw">geom_text</span>( <span class="dt">data=</span>LetterData, <span class="kw">aes</span>(<span class="dt">x=</span>diet, <span class="dt">y=</span>y, <span class="dt">label=</span>.group), <span class="dt">size=</span><span class="dv">10</span> ) </span></code></pre></div>
<p><img src="Statistical-Methods-II_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
</div>
<div id="exercises-8" class="section level2">
<h2><span class="header-section-number">9.5</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Use the dataset <code>chickwts</code> in the <code>datasets</code> package. This was an experiment to determine which feed types result in the largest chickens. A set of 71 chicks were all randomly assigned one of six feed types and their weight in grams after six weeks was recorded. Determine whether there are differences in the weights of chickens according to their feed. Perform all necessary model diagnostics and examine the contrasts between each pair of feed levels. Summarize these results.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="8-variable-selection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="10-two-way-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dereksonderegger/571/raw/master/08_OneWayAnova.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Statistical_Methods_II.pdf", "PDF"], ["Statistical_Methods_II.epub", "EPUB"]],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
